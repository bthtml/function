
 <!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>靖康云管理系统</title>
<link href="../public/css/bootstrap.min.css" rel="stylesheet">
<link href="../public/css/style.css" rel="stylesheet">
<link href="../public/css/eleganticon.css" rel="stylesheet">
<link href="../public/css/sui.min.css" rel="stylesheet">
<link href="../public/css/bootstrap-switch.min.css" rel="stylesheet">
    <!--[if lt IE 9]>
      <script src="../public/js/html5shiv.min.js"></script>
      <script src="../public/js/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<div class="print-top">
<header>
<!-- 载入头部 -->
 <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-8" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a href="/"><img src="../public/img/logo.png" width="143" height="48"  alt=""/></a>
        </div>

        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-8">
          <ul class="nav navbar-nav navbar-right">
<li><a  href='../' target='_self' title='首页'>首页</a> </li><li><a  href='../order/' target='_self' title='订单管理'>订单管理</a> </li><li class="active"><a  href='../console/' target='_self' title='产品管理'>产品管理</a> </li><li><a  href='../payment/' target='_self' title='财务中心'>财务中心</a> </li><li><a  href='../account/' target='_self' title='会员信息'>会员信息</a> </li><li><a  href='../worklist/' target='_self' title='在线帮助'>在线帮助</a> </li>
<li role="presentation" class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
          <span class="glyphicon glyphicon-user"></span>abc****ef@qq.com<span class="caret"></span>
        </a>
        <ul class="dropdown-menu">
<!--          <li><a href="#">Action</a></li>
          <li><a href="#">Another action</a></li>
          <li><a href="#">Something else here</a></li>-->
          <li role="separator" class="divider"></li>
          <li><a href="/data/data.php?action=UserLogout">退出</a></li>
        </ul>
      </li>
          </ul>
        </div>
      </div>
    </nav>

</header>
</div>
<article>
<div class="container-fluid">
      <div class="row">

        <!-- 载入侧边栏 -->
          <div class="col-sm-3 col-md-2 sidebar print-top">

              <div class="navbar-header navbar-inverse navbar-padding row-div" style="padding:0; margin:0;">
                  <button type="button" class="navbar-toggle collapsed pull-left" data-toggle="collapse" data-target="#bs-example-navbar-collapse-9" aria-expanded="false">
                      <span class="sr-only">nav</span>
                      <span class="icon-bar"></span>
                      <span class="icon-bar"></span>
                      <span class="icon-bar"></span>
                  </button>

              </div>
              <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-9" style="padding:0; margin:0;"><ul class="nav nav-sidebar">
                  <p class="no-hover">主机管理</p>
                  <li><a href="./manage.html"><span class="glyphicon glyphicon-tags"></span>详细信息</a></li>
                  <li><a href="./webname.html"><span class="glyphicon glyphicon-home"></span>网站名称修改</a></li>
       				<li><a href="./runingstatus.html"><span class="icon_chat_alt"></span>站点状态</a></li>
                    <li><a href="./hostname.html"><span class="icon_globe-2"></span>绑定主机名</a></li>
                    <li><a href="./homepage.html"><span class="icon_pencil-edit"></span>默认首页设置</a></li>
                    <li ><a href="#" target="_blank"><span class="glyphicon glyphicon-file"></span>文件管理</a></li>
                    <li><a href="./changepassword.html"><span class="glyphicon glyphicon-lock"></span>FTP密码修改</a></li>
                    <li><a href="./siteprotect.html"><span class="icon_documents_alt "></span>站点目录保护</a></li>
                    <li><a href="./page404.html"><span class="icon_error-triangle_alt "></span>404页面设置</a></li>
                    <li><a href=""><span class="glyphicon glyphicon-edit"></span>访问统计</a></li>
                    <li><a href="./email"><span class="glyphicon glyphicon-envelope"></span>邮局管理</a></li>
                    <li><a href="./database"><span class="glyphicon glyphicon-align-justify"></span>数据库</a></li>
                    <li ><a href="http://www.miibeian.gov.cn/" target="_blank"><span class="glyphicon glyphicon-pencil"></span>网站备案</a></li>
                    <li><a href="./db.html"><span class="icon_document_alt "></span>数据库连接范例</a></li>
                    <li><a href="./emailex.html"><span class="icon_document_alt "></span>发送邮件范例</a></li>
                    <li  class="active"><a href="./upLoadfile.html"><span class="icon_document_alt "></span>上传文件范例</a></li>
                  </ul>  </div>        </div>
        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
            <div class="min-main">
                <h4><span class="icon_document_alt  b-color mright-20"></span>上传文件范例</h4>
                
<p style="margin-top:20px;">请选择相应上传文件范例：</p>
<div class="bs-example bs-example-tabs" data-example-id="togglable-tabs">
    <ul id="myTabs" class="nav nav-tabs" role="tablist">
      <li role="presentation" class="dropdown active">
        <a href="#" id="myTabDrop1" class="dropdown-toggle" data-toggle="dropdown" aria-controls="myTabDrop1-contents" aria-expanded="false">&nbsp;各种上传文件范例&nbsp;<span class="caret"></span></a>
        <ul class="dropdown-menu" aria-labelledby="myTabDrop1" id="myTabDrop1-contents">
          <li class="active"><a href="#dropdown1" role="tab" id="dropdown1-tab" data-toggle="tab" aria-controls="dropdown1" aria-expanded="true">ASP 上传文件</a></li>
          <li class=""><a href="#dropdown2" role="tab" id="dropdown2-tab" data-toggle="tab" aria-controls="dropdown2" aria-expanded="false">JSP 上传文件</a></li>
       <li class=""><a href="#dropdown3" role="tab" id="dropdown3-tab" data-toggle="tab" aria-controls="dropdown3" aria-expanded="false">PHP 上传文件</a></li>  
        </ul>
      </li>
    </ul>
    <div id="myTabContent" class="tab-content">
      <div role="tabpanel" class="tab-pane fade active in" id="dropdown1" aria-labelledby="dropdown1-tab">
      <h3>ASP 上传文件</h3>
        <p><pre><%

'==================================================================================================

'程序名称:ASP 上传文件 

  

'程序开发:靖康科技 http://www.3098.com

'版权所有:广州市靖康计算机科技有限公司版权所有

'联系方式:(020)88271083 OICQ：305467508(技术支持) 305470288(业务洽谈)

  

'未经本公司同意不的转载 http://www.3098.com

  '==================================================================================================

Response.Buffer = True
Server.ScriptTimeOut=9999999
On Error Resume Next
'======================================用户修改开始================================================

ExtName = "jpg,gif,png,txt,rar,zip,doc" '允许扩展名

SavePath = "upload" '保存路径

'======================================用户修改结束================================================

'======================================判断文件类型、文件夹是否存在、文件是否存在函数==============

'判断文件类型是否合格
Function CheckFileExt(FileName,ExtName) '文件名,允许上传文件类型
FileType = ExtName 
FileType = Split(FileType,",")
For i = 0 To Ubound(FileType)
If LCase(Right(FileName,3)) = LCase(FileType(i)) then
CheckFileExt = True
Exit Function
Else
CheckFileExt = False
End if
Next
End Function

'检查上传文件夹是否存在，不存在则创建文件夹
Function CheckAndCreateFolder(FolderName)
fldr = Server.Mappath(FolderName)
Set fso = CreateObject("Scripting.FileSystemObject")
If Not fso.FolderExists(fldr) Then
fso.CreateFolder(fldr)
End If
Set fso = Nothing
End Function

'检查文件是否存在，重命名存在文件
Function CheckFileExists(FileName)
Set fso=Server.CreateObject("Scripting.FileSystemObject")
If fso.FileExists(SaveFile) Then
i=1
msg=True
Do While msg
CheckFileExists = Replace(SaveFile,Right(SaveFile,4),"_" & i & Right(SaveFile,4))
If not fso.FileExists(CheckFileExists) Then
msg=False
End If
i=i+1
Loop
Else
CheckFileExists = FileName
End If
Set fso=Nothing
End Function
'======================================判断文件类型、文件夹是否存在、文件是否存在函数结束=========

'======================================上传文件开始===============================================
If Right(SavePath,1)<>"/" Then SavePath=SavePath&"/" '在目录后加(/)
CheckAndCreateFolder(SavePath)

UpLoadAll_a = Request.TotalBytes '取得客户端全部内容
If(UpLoadAll_a>0) Then
Set UploadStream_c = Server.CreateObject("ADODB.Stream")
UploadStream_c.Type = 1
UploadStream_c.Open
UploadStream_c.Write Request.BinaryRead(UpLoadAll_a) 
UploadStream_c.Position = 0

FormDataAll_d = UploadStream_c.Read
CrLf_e = chrB(13)&chrB(10)
FormStart_f = InStrB(FormDataAll_d,CrLf_e)
FormEnd_g = InStrB(FormStart_f+1,FormDataAll_d,CrLf_e)

Set FormStream_h = Server.Createobject("ADODB.Stream")
FormStream_h.Type = 1
FormStream_h.Open
UploadStream_c.Position = FormStart_f + 1
UploadStream_c.CopyTo FormStream_h,FormEnd_g-FormStart_f-3
FormStream_h.Position = 0
FormStream_h.Type = 2
FormStream_h.CharSet = "GB2312"
FormStreamText_i = FormStream_h.Readtext
FormStream_h.Close

FileName_j = Mid(FormStreamText_i,InstrRev(FormStreamText_i,"\")+1,FormEnd_g)

If(CheckFileExt(FileName_j,ExtName)) Then
SaveFile = Server.MapPath(SavePath & FileName_j)

If Err Then
Response.Write " <span style=""color:red;"">文件上传出错!</span>请重新上传文件<br />"
Err.Clear
Else
SaveFile = CheckFileExists(SaveFile)

k=Instrb(FormDataAll_d,CrLf_e&CrLf_e)+4
l=Instrb(k+1,FormDataAll_d,leftB(FormDataAll_d,FormStart_f-1))-k-2
FormStream_h.Type=1
FormStream_h.Open
UploadStream_c.Position=k-1
UploadStream_c.CopyTo FormStream_h,l
FormStream_h.SaveToFile SaveFile,2

SaveFileName = Mid(SaveFile,InstrRev(SaveFile,"\")+1)
Response.write "文件名： <span style=""color:red;"">" & SaveFileName & " </span>文件上传成功!"
End If
Else
Response.write "错误原因： <span style=""color:red;"">文件格式不正确!</span>请重新上传文件<br />"
End If

Set FormStream_h = Nothing
UploadStream.Close
Set UploadStream = Nothing

End If

'======================================上传文件结束===============================================
'======================================显示表单开始===============================================

Response.write "<form action='upload.asp' method='post' name=""upform"" enctype=""multipart/form-data"">"
Response.write "文件上传：<input type='file' name='upfile' size=""40""> <input type='submit' value=""上传""></form>"

'======================================显示表单结束===============================================
%></pre></p>
        
      </div>
      <div role="tabpanel" class="tab-pane fade" id="dropdown2" aria-labelledby="dropdown2-tab">
         <h3>JSP 上传文件 </h3>
         <p><pre>
         <p>&lt;%</p>
         <p>/*==================================================================================================</p>
         <p>程序名称:JSP 上传文件 </p>
         <p> </p>
         <p>程序开发:靖康科技 http://www.3098.com</p>
         <p>版权所有:广州市靖康计算机科技有限公司版权所有</p>
         <p>联系方式:(020)88271083 OICQ：305467508(技术支持) 305470288(业务洽谈)</p>
         <p> </p>
         <p>未经本公司同意不的转载 http://www.3098.com</p>
         <p> ==================================================================================================*/</p>
         <p> %&gt;<br>
           <br>
           &lt;%@ page contentType=&quot;text/html;charset=GB2312&quot;<br>
           import=&quot;com.jspsmart.upload.*,<br>
           java.util.*,<br>
           java.lang.*&quot;<br>
           %&gt;<br>
           &lt;jsp:useBean id=&quot;mySmartUpload&quot; scope=&quot;page&quot; class=&quot;com.jspsmart.upload.SmartUpload&quot; /&gt;</p>
         <p>&lt;%<br>
           //======================================用户修改开始================================================</p>
         <p>final String UpFileType=&quot;zip|rar|doc|jpg|gif&quot;; //上传文件类型<br>
           final int MaxFileSize=10240000; //上传文件大小限制</p>
         <p>//======================================用户修改结束================================================<br>
           String ErrMsg=null; //错误信息<br>
           boolean ERR=false; //错误标志<br>
           mySmartUpload.initialize(pageContext);</p>
         <p>// 上传文件 <br>
           mySmartUpload.upload();</p>
         <p>// 取当前文件<br>
           com.jspsmart.upload.File myFile = mySmartUpload.getFiles().getFile(0);</p>
         <p>// 取得文件并保存<br>
           if (!myFile.isMissing()) {<br>
           //得到文件扩展名<br>
           String FileType=myFile.getFileExt();<br>
           FileType=FileType.toLowerCase(); //将扩展名转换成小写<br>
           if (UpFileType.indexOf(FileType)==-1){<br>
           ERR=true;<br>
           ErrMsg=&quot;上传文件失败！目前只允许上传以下格式的文件：&quot;+UpFileType;<br>
           } <br>
           //得到文件大小<br>
           int FileSize=myFile.getSize();<br>
           if (ERR==false&amp;&amp;FileSize&gt;MaxFileSize){<br>
           ERR=true;<br>
           ErrMsg=&quot;上传文件失败！文件大小超出了限定的范围(最大&quot;+MaxFileSize/1024+&quot;K)&quot;;<br>
           } <br>
           if(ERR==false){<br>
           //保存文件<br>
           String newFileName=&quot;001.&quot;+FileType; //可自动生成文件名以防止同名覆盖<br>
           myFile.saveAs(newFileName);<br>
           }else{<br>
           out.print (&quot;&lt;script&gt;alert('&quot;+ErrMsg+&quot;');&lt;/script&gt;&quot;);<br>
           }<br>
           }<br>
           ?&gt;</p></pre>
         </p>
      </div>
      
            <div role="tabpanel" class="tab-pane fade" id="dropdown3" aria-labelledby="dropdown3-tab">
         <h3>PHP 上传文件 </h3>
         <p><pre><p>&lt;?</p>
        <div>/*==================================================================================================<br>
          程序名称:PHP 上传文件 <br>
  <br>
          程序开发:靖康科技 http://www.3098.com<br>
          版权所有:广州市靖康计算机科技有限公司版权所有<br>
          联系方式:(020)88271083 OICQ：305467508(技术支持) 305470288(业务洽谈)<br>
  <br>
          未经本公司同意不的转载 http://www.3098.com<br>
          ==================================================================================================*/</div>
        <p><br>
          //======================================用户修改开始================================================</p>
        <p>$UpType=array('image/jpg', 'image/jpeg', 'image/gif'); //上传文件类型<br>
          $MaxFileSize=2000000; //设置文件大小<br>
          $FileFolder="design/images/"; //保存路径<br>
          <br>
          //======================================用户修改结束================================================</p>
        <p>if ($_SERVER['REQUEST_METHOD'] == 'POST') <br>
          {<br>
          if (!is_uploaded_file($_FILES["file"][tmp_name])) <br>
          { <br>
          echo "非法上传!"; <br>
          exit; <br>
          } <br>
          $File=$_FILES["file"];<br>
          if($File["size"]&gt; $MaxFileSize)<br>
          {<br>
          echo "文件太大了";<br>
          exit;<br>
          }<br>
          if(!in_array($File["type"],$UpType))<br>
          {<br>
          echo "文件类型不正确".$File["type"];<br>
          exit;<br>
          }<br>
          if(!file_exists($FileFolder))<br>
          {<br>
          mkdir($FileFolder);<br>
          }<br>
          $FileName=$File['tmp_name'];<br>
          $Pinfo=pathinfo($File['name']);<br>
          $Ftype=$Pinfo['extension']; // 取得文件类型 *.jpg<br>
          $Fname=date('YmjHis').".".$Ftype; //重命名文件<br>
          $Destination = $FileFolder.$Fname;<br>
          if (file_exists($Destination))<br>
          {<br>
          echo "文件以存在";<br>
          exit;<br>
          }<br>
          echo $Destination;<br>
          if(!move_uploaded_file ($FileName,$Destination))<br>
          {<br>
          echo "上传出错";<br>
          exit;<br>
          }<br>
          echo "上传成功&lt;br /&gt;";<br>
          }<br>
          //======================================打印表单开始================================================</p>
        <p>echo "&lt;form action=\"upload.php\" method=\"post\" enctype=\"multipart/form-data\" name=\"form1\"&gt;<br>
          &lt;input type=\"file\" name=\"file\"&gt;<br>
          &lt;input type=\"submit\" name=\"Submit\" value=\"提交\"&gt;&lt;/form&gt;";<br>
          <br>
          //======================================打印表单结束================================================<br>
          ?&gt;</p>
          </pre>
          </p>
      </div>

      
    </div>
  </div>

</div>
<div class="print-top">
<footer>
<!-- 载入底部 -->
 <hr>
<div class="container member-footer">
<div class="row">
<div class="col-xs-12 col-md-8">
	<p class="hidden-xs">关于我们  |   联系我们  |   网站地图</p>
    <p  class="hidden-xs">地址：广州市越秀区寺右新马路108号丰伟大厦18楼B单元</p>
	<p> &copy;  2015 广州市靖康计算机科技有限公司版权所有</p>
	<p  class="hidden-xs">IDC运营许可证：粤B1.B2-20030107&nbsp;&nbsp;ISP运营许可证：粤B2-20030107</p>
	<p class="hidden-xs"><img src="../public/img/bottom_36.gif"/></p>
</div>
<div class="col-xs-12 col-md-4 hidden-xs">
<p>销售服务电话:<span class="text-danger">28849383转305</span></p><p>
7×24小时服务热线:<span class="text-danger">15360077791(24h)</span></p><p>
办公电话(9:00--18:00):<span class="text-danger">020-28849383(10线)</span></p><p>
投诉与建议服务热线:<span class="text-danger">13312837020</span></p>
</div>
</div>
</div>
</footer>
</div>
<script src="../public/js/jquery.min.js"></script>
<script src="../public/js/bootstrap.min.js"></script>



        </div>
      </div>
    </div>
</article>
</body></html>